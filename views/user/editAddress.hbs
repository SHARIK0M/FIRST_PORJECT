<main class="main">
    <div class="page-header breadcrumb-wrap">
        <div class="container">
            <div class="breadcrumb">
                <a href="index.html" rel="nofollow">Home</a>
                <span></span> Account
                <span></span> My Address
            </div>
        </div>
    </div>
    <section class="pt-50 pb-150">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 m-auto">
                    <div class="row">
                        {{> profileHeader}}
                        <div class="col-md-9">
                            <section class="content-body p-xl-5 shadow-sm rounded bg-light">
                                <h2 class="mb-4 text-center">Edit Address</h2>
                                <form method="post" action="/edit_address/{{address._id}}" id="addressForm" onsubmit="return validateForm()">
                                    <div class="row">
                                        <div class="col-lg-8 mx-auto">
                                            <div class="row g-3">
                                                <div class="col-12">
                                                    <label class="form-label fw-bold">Name</label>
                                                    <input class="form-control" type="text" placeholder="Enter your name" name="name" id="name" value="{{address.name}}" required>
                                                    <small id="nameError" class="text-danger"></small>
                                                </div>
                                                <div class="col-12">
                                                    <label class="form-label fw-bold">Phone</label>
                                                    <input class="form-control" type="tel" placeholder="Enter your phone number" name="mobile" id="mobile" value="{{address.mobile}}" required>
                                                    <small id="mobileError" class="text-danger"></small>
                                                </div>
                                                <div class="col-12">
                                                    <label class="form-label fw-bold">Address Line 1</label>
                                                    <input class="form-control" type="text" placeholder="Enter your address" name="address1" id="address1" value="{{address.addressLine1}}" required>
                                                    <small id="addressError" class="text-danger"></small>
                                                </div>
                                                <div class="col-md-6">
                                                    <label class="form-label fw-bold">City</label>
                                                    <input class="form-control" type="text" placeholder="Enter your City" name="city" id="city" value="{{address.city}}" required>
                                                    <small id="cityError" class="text-danger"></small>
                                                </div>
                                                <div class="col-md-6">
                                                    <label class="form-label fw-bold">State</label>
                                                    <input class="form-control" type="text" placeholder="Enter your State" name="state" id="state" value="{{address.state}}" required>
                                                    <small id="stateError" class="text-danger"></small>
                                                </div>
                                                <div class="col-12">
                                                    <label class="form-label fw-bold">Pincode</label>
                                                    <input class="form-control" type="tel" placeholder="Enter your Pincode" name="pin" id="pin" value="{{address.pin}}" required>
                                                    <small id="pinError" class="text-danger"></small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="text-center mt-4">
                                        <button type="submit" class="btn btn-primary px-4">Save</button>
                                        <a href="/addresses" class="btn btn-secondary px-4">Back</a>
                                    </div>
                                </form>
                            </section>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    function validateForm() {
        let isValid = true;

        let name = document.getElementById('name').value;
        let mobile = document.getElementById('mobile').value;
        let address1 = document.getElementById('address1').value;
        let city = document.getElementById('city').value;
        let state = document.getElementById('state').value;
        let pin = document.getElementById('pin').value;

        let namePattern = /^[a-zA-Z\s]{3,}$/;
        let mobilePattern = /^\d{10}$/;
        let pinPattern = /^\d{6}$/;

        document.getElementById('nameError').textContent = namePattern.test(name) ? "" : "Invalid name. Only letters and spaces allowed, at least 3 characters.";
        document.getElementById('mobileError').textContent = mobilePattern.test(mobile) ? "" : "Invalid phone number. Must be 10 digits.";
        document.getElementById('addressError').textContent = address1.trim() ? "" : "Address cannot be empty.";
        document.getElementById('cityError').textContent = city.trim() ? "" : "City cannot be empty.";
        document.getElementById('stateError').textContent = state.trim() ? "" : "State cannot be empty.";
        document.getElementById('pinError').textContent = pinPattern.test(pin) ? "" : "Invalid pincode. Must be 6 digits.";

        if (!namePattern.test(name) || !mobilePattern.test(mobile) || !pinPattern.test(pin) || !address1.trim() || !city.trim() || !state.trim()) {
            isValid = false;
        }

        return isValid;
    }
</script>