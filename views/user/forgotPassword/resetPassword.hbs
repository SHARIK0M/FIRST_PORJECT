<main class="main">
    <!-- Breadcrumb Navigation -->
    <div class="page-header breadcrumb-wrap">
        <div class="container">
            <div class="breadcrumb">
                <a href="index.html" rel="nofollow">Home</a>
                <span></span> Register
            </div>
        </div>
    </div>

    <section class="pt-50 pb-150">
        <div class="container">
            <div class="row">
                <div class="col-lg-10 m-auto">
                    <div class="row">
                        <div class="col-lg-6 m-auto">
                            <div class="login_wrap widget-taber-content p-30 background-white border-radius-5">
                                <div class="padding_eight_all bg-white">
                                    <!-- Reset Password Form Header -->
                                    <div class="heading_s1">
                                        <h3 class="mb-30 text-center">Reset your password</h3>
                                    </div>

                                    <!-- Reset Password Form -->
                                    <form action="/resetPassword" method="post" onsubmit="return validatePassword()">
                                        <!-- Display Success/Error Messages -->
                                        <h6 style="color: red;" class="text-center mb-5">{{pasSuccess}}</h6>

                                        <!-- Password Input Field -->
                                        <div class="form-floating mb-3 input-control">
                                            <input type="password" class="form-control" id="password" placeholder="Password" name="password" onchange="validatePassword()" required>
                                            <label for="password">Password</label>
                                             <p style="color: red;" id="passwordError"></p>
                                        </div>

                                        <!-- Confirm Password Input Field -->
                                        <div class="form-floating mb-3 input-control">
                                            <input type="password" class="form-control" id="confirmPassword" placeholder="Confirm Password" name="confirmPassword" onkeyup="validatePassword()" required>
                                            <label for="confirmPassword">Confirm Password</label>
                                           
                                        </div>

                                        <!-- Submit Button -->
                                        <div class="text-center">
                                            <button type="submit" class="btn btn-fill-out btn-block hover-up">Submit</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>

<!-- Password Validation Script -->
<script>
    const password = document.getElementById("password");
    const confirmPassword = document.getElementById("confirmPassword");
    const passwordError = document.getElementById("passwordError");

    // Prevent Copy-Paste in Confirm Password
    confirmPassword.addEventListener("paste", (e) => {
        e.preventDefault();
        alert("Pasting is not allowed in confirm password field.");
    });

    function validatePassword() {
        const passwordValue = password.value.trim();
        const confirmPasswordValue = confirmPassword.value.trim();
        
        // Strong Password Regex
        const strongPasswordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;

        if (!strongPasswordRegex.test(passwordValue)) {
            passwordError.textContent = "Password must be at least 8 characters long, include one uppercase letter, one lowercase letter, one number, and one special character.";
            password.setCustomValidity("Invalid password");
            return false;
        } else {
            password.setCustomValidity("");
        }

        // Check if passwords match
        if (passwordValue !== confirmPasswordValue) {
            passwordError.textContent = "Passwords do not match";
            confirmPassword.setCustomValidity("Passwords do not match");
            return false;
        } else {
            passwordError.textContent = "";
            confirmPassword.setCustomValidity("");
        }
        
        return true;
    }
</script>
